% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/test.clusters.km.R
\name{test.clusters.km}
\alias{test.clusters.km}
\title{Test for the difference of two cluster means after k-means clustering, for matrix normal model with arbitrary scale matrices.}
\usage{
test.clusters.km(
  X,
  U = NULL,
  Sigma = NULL,
  Y = NULL,
  UY = NULL,
  precUY = NULL,
  NC,
  clusters,
  itermax = 10,
  tol = 1e-06
)
}
\arguments{
\item{X}{A \eqn{n \times p} matrix drawn from a \eqn{n \times p} matrix normal distribution \eqn{\mathcal{MN}(}\code{M}, \code{U}, \code{Sigma}\eqn{)}. \code{X} must have \eqn{n} rows and \eqn{p} columns.}

\item{U}{A \eqn{n \times n} positive-definite matrix describing the dependence structure between the rows in \code{X}. If \code{NULL}, observations are considered independent and \code{U} is set to the \eqn{n \times n} identity matrix.}

\item{Sigma}{A \eqn{p \times p} positive-definite matrix describing the dependence structure between the columns in \code{X}. If \code{NULL}, \code{Sigma} is over-estimated (in the sense of the Loewner partial order).}

\item{Y}{If \code{Sigma} is \code{NULL}, an i.i.d. copy of \code{X} allowing its estimation. \code{Y} must have the same number of columns as \code{X}.}

\item{UY}{If \code{Sigma} is \code{NULL}, a positive-definite matrix describing the dependence structure between the rows in \code{Y}. If \code{NULL} and its inverse is not provided, set to the identity matrix by default.}

\item{precUY}{The inverse matrix of \code{UY}, that can be provided to increase computational efficiency. If \code{UY} is not \code{NULL} and \code{precUY} is \code{NULL}, \code{precUY} is obtained by inverting \code{UY}.}

\item{NC}{The number of clusters to choose.}

\item{clusters}{A vector of two integers from 1 to \code{NC} indicating the pair of clusters whose means have to be compared.}

\item{itermax}{The iter.max parameter of the k-means algorithm in kmeans_estimation function of KmeansInference package.}

\item{tol}{The tol_eps parameter of the k-means algorithm in kmeans_estimation function of KmeansInference package.}
}
\value{
\itemize{
  \item pvalue - The p-value for the difference of cluster means.
  \item stat - The test statistic.
  \item km - The partition of the \code{n} observations retrieved by the clustering algorithm.
}
}
\description{
Test for the difference of two cluster means after k-means clustering, for matrix normal model with arbitrary scale matrices.
}
\examples{

n <- 50
p <- 20
M <- Matrix::Matrix(0, nrow = n , ncol = p) # Mean matrix
Sigma <- stats::toeplitz(seq(1, 0.1, length = p)) # Sigma: dependence between features
U <- matrixNormal::I(n) # U: dependence between observations
X <- matrixNormal::rmatnorm(s = 1, M, U, Sigma)
Y <- matrixNormal::rmatnorm(s = 1, M, U, Sigma) # i.i.d. copy of X

# k-means under the global null hypothesis
test.clusters.km(X, U, Sigma, NC = 3, clusters = sample(1:3, 2))
# k-means under the global null hypothesis and over-estimation of Sigma
test.clusters.km(X, U, Sigma = NULL, Y = Y, NC = 3, clusters = sample(1:3, 2))

}
\references{
[1] L. L. Gao, J. Bien, and D. Witten. Selective inference for hierarchical clustering. Journal of the American Statistical Association, 0(0):1â€“11, 2022.
 [2] Y. T. Chen and D. M. Witten. Selective inference for k-means clustering, 2022. arXiv:2203.15267.
}
